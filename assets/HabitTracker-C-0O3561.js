import{r as d,j as t,X as O}from"./index-DqXMfBpZ.js";import{P as H}from"./plus-DXsQ2qju.js";import{C as I}from"./calendar-vc0H8C7r.js";import{D as A}from"./download-DfWGAFzS.js";import{C as L}from"./check-BUCBOD09.js";import{T as E}from"./trending-up-BWy7LnF9.js";function G(){const[r,c]=d.useState(()=>{const e=localStorage.getItem("habits");if(e)try{return JSON.parse(e).map(s=>({...s,completedDates:Array.isArray(s.completedDates)?s.completedDates:Array.from(s.completedDates||[]),longestStreak:s.longestStreak||s.streak||0,createdAt:s.createdAt||new Date().toISOString()}))}catch{return[]}return[]}),[m,u]=d.useState(""),[f,h]=d.useState(null),[x,g]=d.useState(null);d.useEffect(()=>{localStorage.setItem("habits",JSON.stringify(r))},[r]);const i=e=>{h(e),setTimeout(()=>h(null),3e3)},k=()=>{m.trim()&&(c([...r,{id:Date.now().toString(),name:m,streak:0,longestStreak:0,lastCompleted:null,completedDates:[],createdAt:new Date().toISOString()}]),u(""),i("Habit added! ðŸ’ª"))},N=e=>{const s=new Date().toISOString().split("T")[0];c(r.map(a=>{if(a.id!==e)return a;const l=[...a.completedDates],o=l.indexOf(s);if(o>=0){l.splice(o,1);const n=b(l);return{...a,completedDates:l,streak:n,lastCompleted:l.length>0?l[l.length-1]:null}}else{l.push(s),l.sort();const n=b(l),p=Math.max(a.longestStreak,n);return i(`Great job! ðŸŽ‰ ${n} day streak!`),{...a,completedDates:l,streak:n,longestStreak:p,lastCompleted:s}}}))},b=e=>{if(e.length===0)return 0;const s=[...e].sort().reverse(),a=new Date().toISOString().split("T")[0],l=new Date(Date.now()-864e5).toISOString().split("T")[0];if(s[0]!==a&&s[0]!==l)return 0;let o=1;for(let n=0;n<s.length-1;n++){const p=new Date(s[n]),C=new Date(s[n+1]);if((p.getTime()-C.getTime())/(1e3*60*60*24)===1)o++;else break}return o},y=e=>{x===e?(c(r.filter(s=>s.id!==e)),g(null),i("Habit deleted")):(g(e),setTimeout(()=>g(null),3e3))},S=()=>{const e=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download=`habits-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s),i("Habits exported!")},j=(()=>{const e=[];for(let s=6;s>=0;s--){const a=new Date;a.setDate(a.getDate()-s),e.push({date:a.toISOString().split("T")[0],dayName:a.toLocaleDateString("en-US",{weekday:"short"}),dayNum:a.getDate(),isToday:s===0})}return e})(),v=new Date().toISOString().split("T")[0],w=r.reduce((e,s)=>e+s.completedDates.length,0),D=r.length>0?Math.round(r.reduce((e,s)=>e+s.streak,0)/r.length):0,T=r.filter(e=>e.completedDates.includes(v)).length;return t.jsxs("div",{className:"space-y-6",children:[f&&t.jsx("div",{className:"fixed top-4 right-4 z-50 px-4 py-3 rounded-lg shadow-lg bg-green-500 text-white animate-fade-in",children:f}),r.length>0&&t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"card text-center bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20",children:[t.jsxs("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:[T,"/",r.length]}),t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Today"})]}),t.jsxs("div",{className:"card text-center bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:D}),t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Avg Streak"})]}),t.jsxs("div",{className:"card text-center bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20",children:[t.jsx("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:w}),t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Total"})]})]}),t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"flex gap-2 mb-4",children:[t.jsx("input",{type:"text",value:m,onChange:e=>u(e.target.value),onKeyPress:e=>e.key==="Enter"&&k(),placeholder:"Enter habit name (e.g., Exercise, Read, Meditate)",className:"flex-1 input-field"}),t.jsxs("button",{onClick:k,className:"btn-primary flex items-center gap-1",children:[t.jsx(H,{className:"w-5 h-5"}),t.jsx("span",{className:"hidden sm:inline",children:"Add"})]})]}),r.length>0&&t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 flex items-center gap-2",children:[t.jsx(I,{className:"w-4 h-4"}),"Last 7 Days"]}),t.jsxs("button",{onClick:S,className:"btn-secondary text-xs flex items-center gap-1",children:[t.jsx(A,{className:"w-3 h-3"})," Export"]})]}),t.jsxs("div",{className:"grid gap-2",style:{gridTemplateColumns:"1fr repeat(7, 40px) 60px"},children:[t.jsx("div",{className:"text-xs font-medium text-slate-500",children:"Habit"}),j.map(e=>t.jsxs("div",{className:`text-center text-xs ${e.isToday?"font-bold text-blue-600":"text-slate-500"}`,children:[t.jsx("div",{children:e.dayName}),t.jsx("div",{children:e.dayNum})]},e.date)),t.jsx("div",{className:"text-center text-xs font-medium text-slate-500",children:"Streak"})]})]}),t.jsxs("div",{className:"space-y-2",children:[r.map(e=>t.jsxs("div",{className:"grid items-center gap-2 p-2 border border-slate-200 dark:border-slate-700 rounded-lg",style:{gridTemplateColumns:"1fr repeat(7, 40px) 60px"},children:[t.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[t.jsx("span",{className:"font-medium text-slate-900 dark:text-slate-100 truncate",children:e.name}),t.jsx("button",{onClick:()=>y(e.id),className:`p-1 rounded transition-colors flex-shrink-0 ${x===e.id?"text-red-600 animate-pulse":"text-slate-400 hover:text-red-500"}`,title:x===e.id?"Click again to confirm":"Delete habit",children:t.jsx(O,{className:"w-4 h-4"})})]}),j.map(s=>{const a=e.completedDates.includes(s.date),l=s.isToday;return t.jsx("button",{onClick:()=>l&&N(e.id),disabled:!l,className:`w-8 h-8 rounded-lg flex items-center justify-center mx-auto transition-all ${a?"bg-green-500 text-white":l?"bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 cursor-pointer":"bg-slate-100 dark:bg-slate-800 cursor-not-allowed opacity-50"} ${l?"ring-2 ring-blue-500 ring-offset-2 dark:ring-offset-slate-900":""}`,children:a&&t.jsx(L,{className:"w-4 h-4"})},s.date)}),t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t.jsx(E,{className:`w-4 h-4 ${e.streak>0?"text-orange-500":"text-slate-400"}`}),t.jsx("span",{className:`font-bold ${e.streak>0?"text-orange-500":"text-slate-400"}`,children:e.streak})]}),e.longestStreak>e.streak&&t.jsxs("div",{className:"text-[10px] text-slate-400",children:["best: ",e.longestStreak]})]})]},e.id)),r.length===0&&t.jsx("div",{className:"text-center py-8 text-slate-500",children:"No habits yet. Add one to get started! ðŸŒ±"})]})]}),r.length>0&&r.length<3&&t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg p-4 text-sm text-blue-800 dark:text-blue-100",children:[t.jsx("strong",{children:"ðŸ’¡ Tip:"})," Start with 1-3 habits. Once they become automatic (usually 2-3 weeks), add more."]})]})}export{G as default};
