import{r,j as e,C}from"./index-DrWj1tgA.js";import{B as O}from"./book-open-Bb_WTiAc.js";import{C as T}from"./chevron-left-gzlRwg3L.js";import{S as L}from"./save-zzULeing.js";import{D as R}from"./download-DZ1EfTSG.js";import{F as $}from"./file-text-h9bHkSTw.js";function A(){const[n,w]=r.useState(()=>{const t=localStorage.getItem("journalEntries");return t?JSON.parse(t):{}}),[s,x]=r.useState(new Date().toISOString().split("T")[0]),[l,h]=r.useState(n[s]||""),[p,f]=r.useState(null),[g,y]=r.useState(null),c=r.useRef(null);r.useEffect(()=>{h(n[s]||"")},[s,n]),r.useEffect(()=>(c.current&&clearTimeout(c.current),l!==(n[s]||"")&&(c.current=setTimeout(()=>b(!0),2e3)),()=>{c.current&&clearTimeout(c.current)}),[l]);const i=t=>{f(t),setTimeout(()=>f(null),3e3)},j=l.split(/\s+/).filter(t=>t).length,b=(t=!1)=>{const a={...n,[s]:l};w(a),localStorage.setItem("journalEntries",JSON.stringify(a)),y(new Date),t||i("Entry saved! ✨")},v=t=>{const a=new Date(s);a.setDate(a.getDate()+(t==="next"?1:-1)),x(a.toISOString().split("T")[0])},S=()=>{const t=`Journal - ${s}
Words: ${j}
${"=".repeat(20)}

${l}`,a=new Blob([t],{type:"text/plain"}),d=URL.createObjectURL(a),o=document.createElement("a");o.href=d,o.download=`journal-${s}.txt`,o.click(),URL.revokeObjectURL(d),i("Exported!")},k=()=>{const t=Object.keys(n).sort().reverse();if(!t.length){i("No entries");return}let a=`Journal Export (${t.length} entries)
${"=".repeat(30)}

`;t.forEach(N=>{a+=`--- ${N} ---
${n[N]}

`});const d=new Blob([a],{type:"text/plain"}),o=URL.createObjectURL(d),m=document.createElement("a");m.href=o,m.download=`journal-all-${new Date().toISOString().split("T")[0]}.txt`,m.click(),URL.revokeObjectURL(o),i(`Exported ${t.length} entries!`)},u=s===new Date().toISOString().split("T")[0],E=l!==(n[s]||""),D=Object.keys(n).filter(t=>n[t]).length;return e.jsxs("div",{className:"space-y-6",children:[p&&e.jsx("div",{className:"fixed top-4 right-4 z-50 px-4 py-3 rounded-lg shadow-lg bg-green-500 text-white",children:p}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-900 dark:text-slate-100 flex items-center gap-2",children:[e.jsx(O,{className:"w-6 h-6"})," Daily Journal"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>v("prev"),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded",children:e.jsx(T,{className:"w-5 h-5"})}),e.jsx("input",{type:"date",value:s,onChange:t=>x(t.target.value),className:"input-field text-sm"}),e.jsx("button",{onClick:()=>v("next"),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded",children:e.jsx(C,{className:"w-5 h-5"})}),!u&&e.jsx("button",{onClick:()=>x(new Date().toISOString().split("T")[0]),className:"btn-secondary text-xs",children:"Today"})]})]}),e.jsxs("div",{className:"mb-2 text-sm text-slate-600 dark:text-slate-400",children:[new Date(s).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),u&&e.jsx("span",{className:"ml-2 text-blue-600 font-medium",children:"(Today)"})]}),!l&&u&&e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg text-sm text-blue-800 dark:text-blue-100",children:"✍️ How was your day? What are you grateful for?"}),e.jsx("textarea",{value:l,onChange:t=>h(t.target.value),placeholder:"Write your thoughts...",className:"w-full input-field min-h-[300px] resize-y"}),e.jsxs("div",{className:"flex items-center justify-between mt-3 text-sm text-slate-500",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("span",{children:[j," words"]}),E&&e.jsx("span",{className:"text-yellow-600",children:"• Unsaved"})]}),g&&e.jsxs("span",{className:"text-xs",children:["Saved: ",g.toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>b(),className:"btn-primary flex-1 flex items-center justify-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"})," Save"]}),e.jsxs("button",{onClick:S,className:"btn-secondary flex items-center gap-1",children:[e.jsx(R,{className:"w-4 h-4"})," Export"]}),e.jsxs("button",{onClick:k,className:"btn-secondary flex items-center gap-1",children:[e.jsx($,{className:"w-4 h-4"})," All (",D,")"]})]})]})]})}export{A as default};
